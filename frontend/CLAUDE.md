# Frontend Guidelines - Todo Web Application Phase 2

**Project**: Todo Web Application - Frontend  
**Phase**: Phase 2 - Full-Stack Web Application  
**Technology**: Next.js 16+ (App Router) + TypeScript + Shadcn/ui

---

## üîó Coupling with Root CLAUDE.md

This file extends the root `../CLAUDE.md`. **ALWAYS read the root file first** for:
- Project overview and phase information
- Available agents and skills
- Spec-driven development workflow
- PHR and ADR requirements

**Parent Files (Read in Order):**
1. `../CLAUDE.md` - Root project rules
2. `../constitution-prompt-phase-2.md` - Project constitution
3. `../spec-prompt-phase-2.md` - Feature specifications
4. `../plan-prompt-phase-2.md` - Implementation plan

---

## ‚ö†Ô∏è CRITICAL: Pre-Implementation Requirements

### üîç Context7 MCP - ALWAYS USE FIRST

**BEFORE writing ANY frontend code, you MUST fetch latest docs:**

```
1. mcp_context7_resolve-library-id("nextjs") ‚Üí get-library-docs
2. mcp_context7_resolve-library-id("react") ‚Üí get-library-docs  
3. mcp_context7_resolve-library-id("shadcn-ui") ‚Üí get-library-docs
4. mcp_context7_resolve-library-id("framer-motion") ‚Üí get-library-docs
5. mcp_context7_resolve-library-id("tailwindcss") ‚Üí get-library-docs
6. mcp_context7_resolve-library-id("better-auth") ‚Üí get-library-docs
7. mcp_context7_resolve-library-id("zustand") ‚Üí get-library-docs
8. mcp_context7_resolve-library-id("axios") ‚Üí get-library-docs
9. mcp_context7_resolve-library-id("aceternity-ui") ‚Üí get-library-docs
```

**Never assume React/Next.js/Zustand/Axios patterns - verify with Context7 first!**

### ü§ñ Agent Requirement

**ALL frontend code MUST be generated by:** `@frontend-ui-builder`

Do NOT write frontend code directly. Always delegate to the Frontend UI Builder agent.

### üìã Required Spec Reading

Before implementing any UI:

| Spec | Path | Purpose |
|------|------|--------|
| UI Components | `../specs/ui/components.md` | Component requirements |
| UI Pages | `../specs/ui/pages.md` | Page structure |
| Features | `../specs/features/*.md` | Feature requirements |
| API | `../specs/api/rest-endpoints.md` | Backend contracts |
| Auth | `../specs/features/authentication.md` | Auth UI flows |

### üõ†Ô∏è Required Skills

| Task | Skill | Read First |
|------|-------|------------|
| Project setup | `nextjs-setup` | `.claude/skills/nextjs-setup/SKILL.md` |
| Add components | `shadcn-ui-setup` | `.claude/skills/shadcn-ui-setup/SKILL.md` |
| Auth implementation | `better-auth-integration` | `.claude/skills/better-auth-integration/SKILL.md` |

---

## Stack

| Technology | Version | Purpose |
|------------|---------|--------|
| Next.js | 16+ | React framework with App Router |
| TypeScript | 5.0+ | Type-safe JavaScript |
| React | 19 | UI library |
| Tailwind CSS | 4.0 | Utility-first CSS |
| Shadcn/ui | Latest | Component library |
| **Aceternity UI** | **Latest** | **Stunning visual effects & animations** |
| Framer Motion | 11+ | Animations |
| Better Auth | Latest | Authentication |
| **Zustand** | **5.0+** | **State Management (MANDATORY)** |
| **Axios** | **1.7+** | **HTTP Client (MANDATORY)** |

---

## Project Structure

```
frontend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                      # Next.js App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx           # Root layout with providers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx             # Landing page (/)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ not-found.tsx        # 404 page
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ error.tsx            # Error boundary
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loading.tsx          # Loading state
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/              # Auth route group (public)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx       # Auth pages layout
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx     # /login
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ signup/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx     # /signup
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ (dashboard)/         # Protected route group
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ layout.tsx       # Dashboard layout with sidebar
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx     # /dashboard (main tasks view)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ settings/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ page.tsx     # /settings (user settings)
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                  # Shadcn/ui components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aceternity/          # üÜï Aceternity UI effects
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ background-beams.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sparkles.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ text-generate-effect.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ moving-border.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                # Authentication components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login-form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ signup-form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth-guard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks/               # Task-related components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task-list.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task-card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task-form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task-filters.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ empty-state.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/              # Layout components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ header.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sidebar.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ footer.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mobile-nav.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ landing/             # Landing page sections
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ hero-section.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ features-section.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ cta-section.tsx
‚îÇ   ‚îú‚îÄ‚îÄ stores/                   # üÜï Zustand stores (MANDATORY)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-store.ts        # Auth state (user, token, actions)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task-store.ts        # Tasks state (tasks, filters, actions)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui-store.ts          # UI state (modals, sidebar, theme)
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ axios.ts             # üÜï Axios instance with interceptors
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts               # API client using axios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts              # Better Auth config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts             # TypeScript types
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts             # Utilities (cn, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ use-auth.ts          # Auth hook (wraps auth-store)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-tasks.ts         # Tasks hook (wraps task-store)
‚îÇ   ‚îî‚îÄ‚îÄ styles/
‚îÇ       ‚îî‚îÄ‚îÄ globals.css          # Global styles
‚îú‚îÄ‚îÄ public/                       # Static assets
‚îú‚îÄ‚îÄ tests/                        # Tests
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ tailwind.config.ts
‚îú‚îÄ‚îÄ next.config.js
‚îú‚îÄ‚îÄ components.json              # Shadcn/ui config
‚îî‚îÄ‚îÄ .env.local.example
```

---

## üìç Routes & Pages (6 Pages Total)

| Route | Page | Auth | Purpose |
|-------|------|------|--------|
| `/` | Landing | Public | Hero, features, CTA |
| `/login` | Login | Public | User login form |
| `/signup` | Signup | Public | User registration |
| `/dashboard` | Dashboard | Protected | Main tasks view |
| `/settings` | Settings | Protected | User preferences |
| `/*` | 404 | Public | Not found page |

---

## Available Agents

Call these specialized agents for frontend tasks:

| Agent | Command | When to Use |
|-------|---------|-------------|
| **Frontend UI Builder** | `@frontend-ui-builder` | Building components, pages, implementing UI specs |

---

## Available Skills

Use these skills for setup and configuration:

| Skill | Command | When to Use |
|-------|---------|-------------|
| **Next.js Setup** | Reference `nextjs-setup` | Initialize project, configure Next.js |
| **Shadcn/ui Setup** | Reference `shadcn-ui-setup` | Add UI components |
| **Better Auth** | Reference `better-auth-integration` | Implement authentication |

---

## üóÑÔ∏è State Management with Zustand (MANDATORY)

**Rule:** ALL client-side state MUST use Zustand stores. NO manual useState for shared state, NO React Context for state management.

### Store Structure

```
src/stores/
‚îú‚îÄ‚îÄ auth-store.ts      # User authentication state
‚îú‚îÄ‚îÄ task-store.ts      # Tasks data and operations
‚îî‚îÄ‚îÄ ui-store.ts        # UI state (modals, theme, sidebar)
```

### Auth Store Pattern

```tsx
// stores/auth-store.ts
import { create } from 'zustand'
import { persist } from 'zustand/middleware'

interface User {
  id: string
  email: string
  name: string
}

interface AuthState {
  user: User | null
  token: string | null
  isAuthenticated: boolean
  isLoading: boolean
  
  // Actions
  setUser: (user: User, token: string) => void
  logout: () => void
  setLoading: (loading: boolean) => void
}

export const useAuthStore = create<AuthState>()(
  persist(
    (set) => ({
      user: null,
      token: null,
      isAuthenticated: false,
      isLoading: true,
      
      setUser: (user, token) => set({ 
        user, 
        token, 
        isAuthenticated: true,
        isLoading: false 
      }),
      
      logout: () => set({ 
        user: null, 
        token: null, 
        isAuthenticated: false 
      }),
      
      setLoading: (isLoading) => set({ isLoading }),
    }),
    { name: 'auth-storage' }
  )
)
```

### Task Store Pattern

```tsx
// stores/task-store.ts
import { create } from 'zustand'
import { api } from '@/lib/api'

interface Task {
  id: number
  title: string
  description?: string
  completed: boolean
  createdAt: string
}

interface TaskState {
  tasks: Task[]
  isLoading: boolean
  error: string | null
  filter: 'all' | 'active' | 'completed'
  
  // Actions
  fetchTasks: () => Promise<void>
  addTask: (title: string, description?: string) => Promise<void>
  toggleTask: (id: number) => Promise<void>
  deleteTask: (id: number) => Promise<void>
  setFilter: (filter: 'all' | 'active' | 'completed') => void
  
  // Computed (via selectors)
}

export const useTaskStore = create<TaskState>((set, get) => ({
  tasks: [],
  isLoading: false,
  error: null,
  filter: 'all',
  
  fetchTasks: async () => {
    set({ isLoading: true, error: null })
    try {
      const tasks = await api.getTasks()
      set({ tasks, isLoading: false })
    } catch (error) {
      set({ error: 'Failed to fetch tasks', isLoading: false })
    }
  },
  
  addTask: async (title, description) => {
    // Optimistic update
    const tempTask = { id: Date.now(), title, description, completed: false, createdAt: new Date().toISOString() }
    set((state) => ({ tasks: [tempTask, ...state.tasks] }))
    
    try {
      const newTask = await api.createTask({ title, description })
      set((state) => ({ 
        tasks: state.tasks.map(t => t.id === tempTask.id ? newTask : t) 
      }))
    } catch (error) {
      // Rollback on error
      set((state) => ({ tasks: state.tasks.filter(t => t.id !== tempTask.id) }))
    }
  },
  
  toggleTask: async (id) => {
    // Optimistic update
    set((state) => ({
      tasks: state.tasks.map(t => 
        t.id === id ? { ...t, completed: !t.completed } : t
      )
    }))
    
    try {
      await api.toggleTaskComplete(id)
    } catch (error) {
      // Rollback on error
      set((state) => ({
        tasks: state.tasks.map(t => 
          t.id === id ? { ...t, completed: !t.completed } : t
        )
      }))
    }
  },
  
  deleteTask: async (id) => {
    const previousTasks = get().tasks
    set((state) => ({ tasks: state.tasks.filter(t => t.id !== id) }))
    
    try {
      await api.deleteTask(id)
    } catch (error) {
      set({ tasks: previousTasks })
    }
  },
  
  setFilter: (filter) => set({ filter }),
}))

// Selectors
export const useFilteredTasks = () => useTaskStore((state) => {
  const { tasks, filter } = state
  switch (filter) {
    case 'active': return tasks.filter(t => !t.completed)
    case 'completed': return tasks.filter(t => t.completed)
    default: return tasks
  }
})
```

### UI Store Pattern

```tsx
// stores/ui-store.ts
import { create } from 'zustand'

interface UIState {
  isSidebarOpen: boolean
  isAddTaskModalOpen: boolean
  isEditTaskModalOpen: boolean
  editingTaskId: number | null
  theme: 'light' | 'dark' | 'system'
  
  // Actions
  toggleSidebar: () => void
  openAddTaskModal: () => void
  closeAddTaskModal: () => void
  openEditTaskModal: (taskId: number) => void
  closeEditTaskModal: () => void
  setTheme: (theme: 'light' | 'dark' | 'system') => void
}

export const useUIStore = create<UIState>((set) => ({
  isSidebarOpen: true,
  isAddTaskModalOpen: false,
  isEditTaskModalOpen: false,
  editingTaskId: null,
  theme: 'system',
  
  toggleSidebar: () => set((state) => ({ isSidebarOpen: !state.isSidebarOpen })),
  openAddTaskModal: () => set({ isAddTaskModalOpen: true }),
  closeAddTaskModal: () => set({ isAddTaskModalOpen: false }),
  openEditTaskModal: (taskId) => set({ isEditTaskModalOpen: true, editingTaskId: taskId }),
  closeEditTaskModal: () => set({ isEditTaskModalOpen: false, editingTaskId: null }),
  setTheme: (theme) => set({ theme }),
}))
```

### Using Stores in Components

```tsx
"use client"

import { useTaskStore, useFilteredTasks } from '@/stores/task-store'
import { useUIStore } from '@/stores/ui-store'

export function TaskList() {
  const tasks = useFilteredTasks()
  const { isLoading, toggleTask, deleteTask } = useTaskStore()
  const { openEditTaskModal } = useUIStore()
  
  if (isLoading) return <LoadingSpinner />
  
  return (
    <ul>
      {tasks.map(task => (
        <TaskItem 
          key={task.id} 
          task={task}
          onToggle={() => toggleTask(task.id)}
          onEdit={() => openEditTaskModal(task.id)}
          onDelete={() => deleteTask(task.id)}
        />
      ))}
    </ul>
  )
}
```

### State Management Rules

| ‚ùå DON'T | ‚úÖ DO |
|----------|-------|
| `useState` for shared state | Zustand store |
| React Context for state | Zustand store |
| Prop drilling | Direct store access |
| Manual state sync | Zustand persist middleware |
| useReducer for complex state | Zustand with actions |

---

## üåê HTTP Client with Axios (MANDATORY)

**Rule:** ALL API calls MUST use Axios. NO fetch() for API calls.

### Axios Instance Setup

```tsx
// lib/axios.ts
import axios from 'axios'
import { useAuthStore } from '@/stores/auth-store'

const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'

export const axiosInstance = axios.create({
  baseURL: API_BASE_URL,
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json',
  },
})

// Request interceptor - Add JWT token
axiosInstance.interceptors.request.use(
  (config) => {
    const token = useAuthStore.getState().token
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  (error) => Promise.reject(error)
)

// Response interceptor - Handle errors
axiosInstance.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      // Token expired - logout user
      useAuthStore.getState().logout()
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)

export default axiosInstance
```

### API Client with Axios

```tsx
// lib/api.ts
import axiosInstance from './axios'
import { Task, TaskCreate, TaskUpdate, User } from './types'

export const api = {
  // Auth
  login: async (email: string, password: string) => {
    const { data } = await axiosInstance.post('/api/auth/login', { email, password })
    return data
  },
  
  signup: async (name: string, email: string, password: string) => {
    const { data } = await axiosInstance.post('/api/auth/signup', { name, email, password })
    return data
  },
  
  // Tasks
  getTasks: async () => {
    const { data } = await axiosInstance.get<{ data: Task[] }>('/api/tasks')
    return data.data
  },
  
  createTask: async (task: TaskCreate) => {
    const { data } = await axiosInstance.post<{ data: Task }>('/api/tasks', task)
    return data.data
  },
  
  updateTask: async (id: number, task: TaskUpdate) => {
    const { data } = await axiosInstance.put<{ data: Task }>(`/api/tasks/${id}`, task)
    return data.data
  },
  
  toggleComplete: async (id: number) => {
    const { data } = await axiosInstance.patch<{ data: Task }>(`/api/tasks/${id}/complete`)
    return data.data
  },
  
  deleteTask: async (id: number) => {
    await axiosInstance.delete(`/api/tasks/${id}`)
  },
}
```

### HTTP Client Rules

| ‚ùå DON'T | ‚úÖ DO |
|----------|-------|
| `fetch()` for API calls | `axiosInstance` |
| Manual header management | Axios interceptors |
| Inline error handling | Centralized interceptors |
| Hardcoded API URLs | Environment variables |

---

## ‚ú® Aceternity UI Effects (MANDATORY for Landing Page)

**Rule:** Landing page MUST use Aceternity UI for stunning visual effects.

### Available Aceternity Components

| Component | Usage |
|-----------|-------|
| `BackgroundBeams` | Hero section background |
| `SparklesCore` | Sparkle effects on headings |
| `TextGenerateEffect` | Animated text reveal |
| `MovingBorder` | Animated button borders |
| `HeroHighlight` | Highlighted hero text |
| `LampContainer` | Lamp lighting effect |
| `BackgroundGradient` | Gradient card backgrounds |

### Landing Page Hero with Aceternity

```tsx
// components/landing/hero-section.tsx
"use client"

import { BackgroundBeams } from '@/components/aceternity/background-beams'
import { TextGenerateEffect } from '@/components/aceternity/text-generate-effect'
import { MovingBorder } from '@/components/aceternity/moving-border'
import { Button } from '@/components/ui/button'
import Link from 'next/link'

export function HeroSection() {
  return (
    <div className="relative min-h-screen flex items-center justify-center overflow-hidden">
      <BackgroundBeams />
      
      <div className="relative z-10 text-center px-4">
        <TextGenerateEffect
          words="Organize your life, one task at a time"
          className="text-4xl md:text-6xl font-bold text-white mb-6"
        />
        
        <p className="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
          The modern todo app that helps you stay focused and accomplish more.
        </p>
        
        <div className="flex gap-4 justify-center">
          <Link href="/signup">
            <MovingBorder
              borderRadius="1.75rem"
              className="bg-white text-black px-8 py-3 font-semibold"
            >
              Get Started Free
            </MovingBorder>
          </Link>
          
          <Button variant="outline" size="lg" asChild>
            <Link href="#features">Learn More</Link>
          </Button>
        </div>
      </div>
    </div>
  )
}
```

### Aceternity Component Setup

```bash
# Copy Aceternity components from their repo
# https://ui.aceternity.com/components

# Place in src/components/aceternity/
```

### Aceternity Usage Rules

| Page | Required Effects |
|------|------------------|
| Landing (`/`) | BackgroundBeams, TextGenerateEffect, MovingBorder |
| Login/Signup | BackgroundGradient (optional) |
| Dashboard | None (keep it clean/fast) |

---

## Development Patterns

### Server Components (Default)

Use Server Components by default for:
- Data fetching
- Static content
- SEO-critical pages

```tsx
// app/tasks/page.tsx - Server Component
import { api } from '@/lib/api'

export default async function TasksPage() {
  const tasks = await api.getTasks() // Server-side fetch
  return <TaskList tasks={tasks} />
}
```

### Client Components

Add `"use client"` only when needed for:
- Event handlers (onClick, onChange)
- Browser APIs
- Zustand stores
- Effects (useEffect)

```tsx
"use client"

import { useTaskStore } from '@/stores/task-store'

export function TaskItem({ task }) {
  const { toggleTask } = useTaskStore()
  // ...
}
```

### API Client

All backend calls should use the centralized API client:

```tsx
import { api } from '@/lib/api'

// Fetch tasks
const tasks = await api.getTasks(userId)

// Create task
const newTask = await api.createTask(userId, { title: 'New Task' })

// Update task
await api.updateTask(userId, taskId, { title: 'Updated' })

// Delete task
await api.deleteTask(userId, taskId)

// Toggle complete
await api.toggleTaskComplete(userId, taskId)
```

---

## Component Guidelines

### Shadcn/ui Components

Import from `@/components/ui`:

```tsx
import { Button } from '@/components/ui/button'
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'
import { Input } from '@/components/ui/input'
import { Checkbox } from '@/components/ui/checkbox'
```

### Framer Motion Animations

Use for task list animations:

```tsx
import { motion, AnimatePresence } from 'framer-motion'

<AnimatePresence>
  {tasks.map(task => (
    <motion.div
      key={task.id}
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0, x: -100 }}
    >
      <TaskItem task={task} />
    </motion.div>
  ))}
</AnimatePresence>
```

### Form Handling

Use React Hook Form with Zod validation:

```tsx
import { useForm } from 'react-hook-form'
import { zodResolver } from '@hookform/resolvers/zod'
import { z } from 'zod'

const taskSchema = z.object({
  title: z.string().min(1).max(200),
  description: z.string().max(1000).optional(),
})

const form = useForm({
  resolver: zodResolver(taskSchema),
})
```

---

## Styling Rules

1. **Use Tailwind CSS classes** - No inline styles
2. **Use `cn()` utility** for conditional classes
3. **Follow existing component patterns**
4. **Mobile-first responsive design**

```tsx
import { cn } from '@/lib/utils'

<div className={cn(
  "p-4 rounded-lg",
  isCompleted && "opacity-50 line-through"
)}>
```

---

## Authentication Flow

### Protected Routes

Use middleware for route protection:

```tsx
// middleware.ts
export function middleware(request: NextRequest) {
  const token = request.cookies.get('auth-token')
  if (!token && request.nextUrl.pathname.startsWith('/tasks')) {
    return NextResponse.redirect(new URL('/login', request.url))
  }
}
```

### Auth Context

Use the auth provider:

```tsx
import { useAuth } from '@/components/providers/auth-provider'

function Component() {
  const { user, isAuthenticated, signOut } = useAuth()
  // ...
}
```

---

## Testing Strategy

| Type | Tool | Coverage Goal |
|------|------|---------------|
| Unit | Jest + RTL | Components |
| Integration | Jest | Hooks, API client |
| E2E | Playwright | Critical user flows |

**Target Coverage**: 70%

---

## Environment Variables

```env
# .env.local
NEXT_PUBLIC_API_URL=http://localhost:8000
BETTER_AUTH_SECRET=your-secret-key-min-32-chars
NEXTAUTH_URL=http://localhost:3000
```

---

## Quick Commands

```bash
# Development
npm run dev

# Build
npm run build

# Test
npm run test

# Lint
npm run lint

# Add Shadcn component
npx shadcn-ui@latest add button
```

---

## Specifications

Always reference specs before implementing:

| Spec | Path | Content |
|------|------|---------|
| UI Components | `../specs/ui/components.md` | Component requirements |
| Pages | `../specs/ui/pages.md` | Page structure |
| Features | `../specs/features/` | Feature requirements |
| API | `../specs/api/rest-endpoints.md` | API contracts |

---

## Quality Checklist

Before considering frontend work complete:

- [ ] Server Components used by default
- [ ] Client Components only where needed
- [ ] Responsive design (320px+)
- [ ] Accessibility (keyboard nav, ARIA)
- [ ] Loading states implemented
- [ ] Error states implemented
- [ ] Animations smooth (60fps)
- [ ] TypeScript strict mode passing
- [ ] Tests written and passing
- [ ] No console errors/warnings
